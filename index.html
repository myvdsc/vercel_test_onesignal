<!DOCTYPE html>
<html>
<head>
  <title>OneSignal Web Push Test</title>
  <script src="https://cdn.onesignal.com/sdks/OneSignalSDK.js" async=""></script>
</head>
<body>
  <h2>Test OneSignal Web Push</h2>
  <button id="subscribeBtn" disabled>Đăng ký nhận thông báo</button>
  <pre id="log"></pre>

  <script>
    window.OneSignal = window.OneSignal || [];
    OneSignal.push(function() {
      OneSignal.init({
        appId: "b4d193bd-ac32-4a10-9141-16fca44adddd", // thay YOUR_APP_ID bằng App ID thật
        notifyButton: { enable: true }
      });

      // Bật nút đăng ký sau khi init xong
      document.getElementById('subscribeBtn').disabled = false;

      OneSignal.on('subscriptionChange', function (isSubscribed) {
        if (isSubscribed) {
          OneSignal.getUserId(function(playerId) {
            document.getElementById("log").textContent = "Player ID: " + playerId;
            console.log("Player ID:", playerId);
          });
        } else {
          document.getElementById("log").textContent = "User chưa cho phép push";
        }
      });
    });

    document.getElementById('subscribeBtn').onclick = function() {
      OneSignal.push(function() {
        OneSignal.registerForPushNotifications()
          .then(() => console.log('Đăng ký thành công'))
          .catch(err => console.error('Lỗi đăng ký', err));
      });
    };
  </script>
</body>
</html>